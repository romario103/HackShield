<!DOCTYPE html>
<html>
<head>
    <title>HackShield - De Talentenfontein</title>
    <style>
        body {
            margin: 0;
            padding: 20px;
            background: #000;
            font-family: monospace;
        }
        
        .video-container {
            position: relative;
            width: 100%;
            max-width: 800px;
            height: 450px;
            margin: 0 auto;
            background: #111;
            overflow: hidden;
        }
        
        .video-layer {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            opacity: 0;
            transition: opacity 0.3s;
            object-fit: contain;
        }
        
        .video-layer.active {
            opacity: 1;
            z-index: 2;
        }
        
        .video-layer.preloading {
            opacity: 0;
            z-index: 1;
        }
        
        .controls {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-top: 20px;
        }
        
        .control-btn {
            background: #333;
            color: white;
            border: none;
            width: 60px;
            height: 60px;
            font-size: 24px;
            cursor: pointer;
            border-radius: 50%;
        }
        
        .control-btn:hover {
            background: #555;
        }
        
        .status {
            text-align: center;
            color: #0f0;
            margin-top: 10px;
            font-size: 12px;
            height: 20px;
        }
    </style>
</head>
<body>
    <div class="video-container">
        <!-- Actieve video -->
        <video class="video-layer active" id="currentVideo"></video>
        
        <!-- Preload video (volgende) -->
        <video class="video-layer preloading" id="nextVideo" preload="auto"></video>
        
        <!-- Preload video (vorige) -->
        <video class="video-layer preloading" id="prevVideo" preload="auto"></video>
    </div>
    
    <div class="controls">
        <button class="control-btn" id="prevBtn">&lt;</button>
        <button class="control-btn" id="pauseBtn">⏸</button>
        <button class="control-btn" id="nextBtn">&gt;</button>
    </div>
    
    <div class="status" id="status"></div>

    <script>
        // Video playlist
        const videos = [
            {
                title: "Intro",
                src: "Talentenfontein 01.mp4",
                loop: true
            },
            {
                title: "Intro", 
                src: "Talentenfontein 02.mp4",
                loop: false
            },
            {
                title: "Intro",
                src: "Talentenfontein 03.mp4",
                loop: true
            },
            {
                title: "Intro",
                src: "Talentenfontein 04.mp4",
                loop: false
            },
            {
                title: "Intro",
                src: "Talentenfontein 05.mp4",
                loop: false
            },
            {
                title: "Talent van De Doener",
                src: "Talentenfontein 06.mp4",
                loop: true
            },
            {
                title: "Talent van De Onderzoeker",
                src: "Talentenfontein 07.mp4",
                loop: false
            },
            {
                title: "Talent van De Onderzoeker",
                src: "Talentenfontein 08.mp4",
                loop: true
            },
            {
                title: "Talent van De Verbinder",
                src: "Talentenfontein 09.mp4",
                loop: false
            },
            {
                title: "Talent van De Verbinder",
                src: "Talentenfontein 10.mp4",
                loop: false
            },
            {
                title: "Talent van De Ontwerper",
                src: "Talentenfontein 11.mp4",
                loop: false
            },
            {
                title: "Talent van De Ontwerper",
                src: "Talentenfontein 12.mp4",
                loop: true
            },
            {
                title: "Talent van De Ontwerper",
                src: "Talentenfontein 13.mp4",
                loop: true
            },
            {
                title: "Einde",
                src: "Talentenfontein 14.mp4",
                loop: false
            },
            {
                title: "Einde",
                src: "Talentenfontein 15.mp4",
                loop: true
            }
        ];

        // DOM elements
        const currentVideo = document.getElementById('currentVideo');
        const nextVideo = document.getElementById('nextVideo');
        const prevVideo = document.getElementById('prevVideo');
        const prevBtn = document.getElementById('prevBtn');
        const nextBtn = document.getElementById('nextBtn');
        const status = document.getElementById('status');
        
        // State
        let currentIndex = 0;
        
        // Bereken indexen met wrap-around
        function getNextIndex(index) {
            return (index + 1) % videos.length;
        }
        
        function getPrevIndex(index) {
            return (index - 1 + videos.length) % videos.length;
        }
        
        // Update status display
        function updateStatus() {
            const nextIdx = getNextIndex(currentIndex);
            const prevIdx = getPrevIndex(currentIndex);
            status.textContent = `Huidig: ${currentIndex + 1} | Volgende: ${nextIdx + 1} (${nextVideo.readyState}) | Vorige: ${prevIdx + 1} (${prevVideo.readyState})`;
        }
        
        // Laad video in element
        function loadVideoToElement(element, index) {
            const video = videos[index];
            element.src = video.src;
            element.loop = video.loop;
            element.load(); // Forceer preloading
            
            // Log wanneer video klaar is
            element.onloadeddata = () => {
                console.log(`Preloaded: ${video.title} (${video.loop ? 'loop' : 'once'})`);
                updateStatus();
            };
            
            element.onerror = () => {
                console.error(`Fout bij laden: ${video.title}`);
            };
        }
        
        // Schakel tussen video's met crossfade
        function switchToVideo(index) {
            const oldIndex = currentIndex;
            currentIndex = index;
            
            // Update actieve video
            const video = videos[currentIndex];
            currentVideo.src = video.src;
            currentVideo.loop = video.loop;
            currentVideo.currentTime = 0;
            
            // Herstart preloads voor nieuwe positie
            preloadAdjacentVideos();
            
            // Speel nieuwe video
            currentVideo.play().catch(e => {
                console.log("Autoplay blocked, user must click");
            });
            
            // Log
            console.log(`Switched to: ${video.title} (index: ${currentIndex})`);
            updateStatus();
        }
        
        // Preload vorige en volgende video
        function preloadAdjacentVideos() {
            const nextIdx = getNextIndex(currentIndex);
            const prevIdx = getPrevIndex(currentIndex);
            
            loadVideoToElement(nextVideo, nextIdx);
            loadVideoToElement(prevVideo, prevIdx);
        }
        
        // Naar volgende video (gebruik preloaded video)
        function next() {
            const nextIdx = getNextIndex(currentIndex);
            
            // Wissel videos - maak nextVideo de actieve
            [currentVideo.src, nextVideo.src] = [nextVideo.src, currentVideo.src];
            [currentVideo.loop, nextVideo.loop] = [nextVideo.loop, currentVideo.loop];
            
            // Reset tijd en speel
            currentVideo.currentTime = 0;
            currentVideo.play();
            
            // Update index
            currentIndex = nextIdx;
            
            // Preload nieuwe adjacente videos
            preloadAdjacentVideos();
            
            console.log(`Next: ${videos[currentIndex].title}`);
            updateStatus();
        }
        
        // Naar vorige video (gebruik preloaded video)
        function prev() {
            const prevIdx = getPrevIndex(currentIndex);
            
            // Wissel videos - maak prevVideo de actieve
            [currentVideo.src, prevVideo.src] = [prevVideo.src, currentVideo.src];
            [currentVideo.loop, prevVideo.loop] = [prevVideo.loop, currentVideo.loop];
            
            // Reset tijd en speel
            currentVideo.currentTime = 0;
            currentVideo.play();
            
            // Update index
            currentIndex = prevIdx;
            
            // Preload nieuwe adjacente videos
            preloadAdjacentVideos();
            
            console.log(`Prev: ${videos[currentIndex].title}`);
            updateStatus();
        }

        // Met knop tekst/icoon update
        function togglePause() {
            const video = document.getElementById('currentVideo');
            const pauseBtn = document.getElementById('pauseBtn');
            
            if (video.paused) {
                video.play();
                pauseBtn.textContent = '⏸'; // Pauze icoon
            } else {
                video.pause();
                pauseBtn.textContent = '▶'; // Play icoon
            }
        }
        
        // Event listeners
        prevBtn.onclick = prev;
        nextBtn.onclick = next;
        pauseBtn.onclick = togglePause;
        
        // Automatisch volgende bij einde (geen loop)
        currentVideo.onended = () => {
            if (!videos[currentIndex].loop) {
                console.log("Video ended, auto-next");
                setTimeout(next, 100); // Kleine delay voor betere UX
            }
        };
        
        // Toetsenbord shortcuts
        document.onkeydown = (e) => {
            if (e.key === 'ArrowLeft') prev();
            if (e.key === 'ArrowRight') next();
        };
        
        // Initialize
        function init() {
            // Laad eerste video
            loadVideoToElement(currentVideo, 0);
            currentVideo.play();
            
            // Preload volgende en vorige
            preloadAdjacentVideos();
            
            console.log("Player initialized with preloading");
            updateStatus();
        }
        
        // Start
        init();
    </script>
</body>
</html>
